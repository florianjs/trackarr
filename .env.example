# =============================================================================
# OpenTracker Environment Configuration
# =============================================================================
# This file works for both development and production.
# Copy to .env and adjust values as needed.
#
# DEVELOPMENT: Use defaults as-is with `docker compose up -d`
# PRODUCTION:  Use docker-compose.prod.yml and generate all secrets below

# -----------------------------------------------------------------------------
# Environment Mode
# -----------------------------------------------------------------------------
NODE_ENV=development

# -----------------------------------------------------------------------------
# Domain Configuration (Production only)
# -----------------------------------------------------------------------------
# DOMAIN=your-tracker.com
# TRACKER_DOMAIN=tracker.your-tracker.com
# MONITORING_DOMAIN=monitoring.your-tracker.com
# ACME_EMAIL=admin@your-tracker.com

# -----------------------------------------------------------------------------
# Database (PostgreSQL)
# -----------------------------------------------------------------------------
# Development (SSL disabled)
DATABASE_URL=postgres://tracker:tracker@localhost:5432/opentracker

# Production (SSL enforced - sslmode=require automatically added in nuxt.config.ts)
# DATABASE_URL=postgres://tracker:STRONG_PASSWORD@pgbouncer:6432/opentracker

# Production database settings
DB_USER=tracker
# ⚠️  PRODUCTION: Generate with: openssl rand -base64 32
DB_PASSWORD=tracker
DB_NAME=opentracker
DB_PORT=5432

# Database connection pool
DB_POOL_MAX=20

# SSL/TLS for database connections
# Development: SSL disabled for local testing
# Production: SSL automatically enforced (see documentation/ssl-setup.md)
# Generate certificates with: ./scripts/generate-ssl-certs.sh

# Debug mode (never enable in production)
DB_DEBUG=false

# -----------------------------------------------------------------------------
# Redis
# -----------------------------------------------------------------------------
REDIS_URL=redis://localhost:6379

# Redis authentication (REQUIRED for production)
REDIS_PASSWORD=

# Redis key prefix (namespace isolation)
REDIS_KEY_PREFIX=ot:

# Redis port (for docker-compose)
REDIS_PORT=6379

# SSL/TLS for Redis connections
REDIS_TLS=false
REDIS_TLS_REJECT_UNAUTHORIZED=true
# REDIS_TLS_CA=/path/to/ca-certificate.crt

# -----------------------------------------------------------------------------
# Tracker Ports
# -----------------------------------------------------------------------------
TRACKER_PORT=8000
TRACKER_HTTP_PORT=8080
TRACKER_UDP_PORT=8081
TRACKER_WS_PORT=8082

# Debug mode for verbose tracker logging (logs raw announce params)
TRACKER_DEBUG=false

# Tracker announce URLs (displayed in admin dashboard for .torrent files)
# ⚠️  PRODUCTION: Configure these with your actual domain
TRACKER_HTTP_URL=https://tracker.your-domain.com/announce
TRACKER_UDP_URL=udp://tracker.your-domain.com:8081/announce
TRACKER_WS_URL=wss://tracker.your-domain.com/ws

# -----------------------------------------------------------------------------
# Security
# -----------------------------------------------------------------------------

# Session encryption (REQUIRED for production - generate with: openssl rand -hex 32)
NUXT_SESSION_SECRET=

# Admin API key (REQUIRED for production - generate with: openssl rand -hex 32)
ADMIN_API_KEY=

# IP hashing secret (REQUIRED for production - generate with: openssl rand -hex 32)
IP_HASH_SECRET=opentracker-default-secret-change-me

# -----------------------------------------------------------------------------
# Monitoring (Production only - Grafana)
# -----------------------------------------------------------------------------
# GRAFANA_ADMIN_USER=admin
# GRAFANA_ADMIN_PASSWORD=CHANGE_THIS_SECURE_PASSWORD

# Monitoring Basic Auth (generate hash with: caddy hash-password)
# MONITORING_USER=admin
# MONITORING_PASSWORD_HASH=

# -----------------------------------------------------------------------------
# Quick Start
# -----------------------------------------------------------------------------
#
# DEVELOPMENT:
#   cp .env.example .env
#   docker compose up -d
#   npm run dev
#
# PRODUCTION:
#   cp .env.example .env
#   # Generate all secrets:
#   echo "NODE_ENV=production" >> .env
#   echo "NUXT_SESSION_SECRET=$(openssl rand -hex 32)" >> .env
#   echo "ADMIN_API_KEY=$(openssl rand -hex 32)" >> .env
#   echo "IP_HASH_SECRET=$(openssl rand -hex 32)" >> .env
#   echo "DB_PASSWORD=$(openssl rand -base64 24)" >> .env
#   echo "REDIS_PASSWORD=$(openssl rand -base64 24)" >> .env
#   echo "GRAFANA_ADMIN_PASSWORD=$(openssl rand -base64 16)" >> .env
#   # Configure domains
#   echo "DOMAIN=your-tracker.com" >> .env
#   # Start
#   docker compose -f docker-compose.prod.yml up -d

